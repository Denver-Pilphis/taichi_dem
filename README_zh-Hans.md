# 使用 Taichi DEM 进行工程定量离散单元法仿真
从工程角度使用太极语言完整实现离散单元法。

![](Demos/carom/carom.gif)

![](Demos/cube_911_particles_impact/cube_911_particles_impact.gif)

![](Demos/cube_18112_particles_impact/cube_18112_particles_impact.gif)

>使用BIMBase二次开发可视化。BIMBase是北京构力科技研发的用于BIM的图形平台。https://app.pkpm.cn/pbims

## 作者

Denver Pilphis (Di Peng) - 离散单元法理论与实现

MuGdxy (Xinyu Lu) - 性能优化

## 简介

本例提供一个完整的离散单元法 (DEM) 仿真的实现，考虑了复杂的DEM力学机制，仿真结果达到工程定量精度。

本例使用Taichi语言，加上适当的数据结构和算法，以保障计算效率。

## 新增功能

相比Taichi DEM原始版本，本例增加了如下功能：

1. 二维离散单元法→三维离散单元法：如不考虑转动方向，从二维到三维只是简单的力、位移、速度、加速度等参量从二维变为三维；但如考虑转动，情况将会复杂许多。一个简单的例子，二维离散元中，颗粒所受合力矩$M$与角速度$\omega$均为标量，因相应向量方向固定为面外；而三维离散元中，$\boldsymbol{M}$与$\boldsymbol{\omega}$均为三维向量，且还有局部全局之分。

2. 完整考虑并实现颗粒方位和旋转，预留了建模和仿真非球形颗粒的空间：虽然本例中使用的依旧是球形颗粒，但颗粒转动惯量张量$\boldsymbol{I}$完全实现，颗粒方位以四元数$\boldsymbol{q}=[\begin{matrix} q_w & q_x & q_y & q_z \end{matrix}]$实现，在时间积分阶段颗粒角加速度$\dot{\boldsymbol{\omega}}$的计算使用了欧拉方程 (参考文献：https://doi.org/10.1002/nme.6568)。这些功能均直接适用于任意形状颗粒，为今后非球形颗粒的建模和仿真打下了基础。

3. 实现了墙 (离散元中的边界) 单元，并实现了颗粒-墙接触解算：离散元中不仅有颗粒对颗粒的作用，也有颗粒对边界的作用。本例中实现的墙单元，为最简单的无限平面边界单元。它由函数$f(\boldsymbol{x})=Ax+By+Cz-D=0$确定，其中$\boldsymbol{n}=[\begin{matrix} A & B & C \end{matrix}]$为外法向量，$D$为距离原点距离。颗粒与墙的碰撞检测并不复杂，接触模型使用Hertz-Mindlin模型 (参考文献：https://doi.org/10.1115/1.4010702)。

4. 实现了复杂离散元接触模型，包括一个胶结模型 (爱丁堡胶结颗粒模型，EBPM) 和一个颗粒接触模型 (Hertz-Mindlin接触模型) ：离散元相比有限元等其他数值方法的一大优势是，它可以仿真大变形问题，如开裂、破碎等。开裂和破碎等问题一般使用颗粒胶结接触模型来模拟。颗粒间胶结在某一早期状态通过命令生成，胶结可在两个颗粒间传递力和弯矩。之后，胶结两端颗粒的位移会引起胶结变形，利用接触本构关系可以计算得到胶结的内力，作用在两端颗粒上。当胶结所受内力 (或应力) 足够大，超过其强度 (事先预设) 时，胶结发生破坏，不再在颗粒间传力，相当于颗粒间接触消失。本例的胶结模型为EBPM (参考文献：https://doi.org/10.1007/s10035-014-0494-4)，胶结破坏后，颗粒间非胶结接触模型变为Hertz-Mindlin模型 (参考文献：https://doi.org/10.1115/1.4010702)。

5. 因胶结模型已实现，可以使用胶结团块模拟非球形颗粒：非球形颗粒的建模有很多种，常见的几种分别为：多球团簇 (multisphere clump) 、胶结团块 (bonded agglomerate) 、连续函数表面描述 (continuous function representation) 、离散点表面描述 (discrete function representation) 等 (参考文献：https://doi.org/10.1016/j.ces.2014.11.050)。因为EBPM胶结模型可用，可以实现胶结团块，团块的尺寸也可以根据用户需要变化，相当于实现了非球形颗粒的建模与仿真。

6. 因胶结模型已实现，可以仿真颗粒破碎过程：使用胶结团块模拟非球形颗粒时，该颗粒受力过程中，颗粒内部胶结受力可能发生破坏，从而导致颗粒发生破碎。因此，颗粒破碎过程也可通过此方法来仿真。

## 示例

### 开仑台球

本例展示了开仑台球开局第一球。白球正对其他球运动并发生碰撞，然后球散开。虽然该过程中有能量损失，但是由于没有抗转动力学响应耗散转动动能，所有的球在进入纯滚动状态后将会一直滚动下去。本例可用于验证Hertz-Mindlin模型。

![](Demos/carom/carom.gif)

### 911个颗粒胶结组成的立方体团块撞击平整表面

本例展示了一个立方体胶结团块撞击平整表面的过程。
撞击过程中，团块内部的胶结受力将发生破坏，然后团块碎成碎片，飞向周围空间。
本例可用于验证EBPM模型。

![](Demos/cube_911_particles_impact/cube_911_particles_impact.gif)

### 18112个颗粒胶结组成的立方体团块撞击平整表面

本例与上例相似，唯独团块所含颗粒数不同。本例可用于大规模体系仿真的性能测试。

![](Demos/cube_18112_particles_impact/cube_18112_particles_impact.gif)

## 致谢

感谢谢菲尔德大学化学与生物工程学院Xizhong Chen博士对本研究给予的帮助和支持。
